<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WAESCAPS - Catálogo</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{
      --header-bg:#111;
      --header-total:100px;
      --header-border:#1c1c1c;
      --header-input-border:#2a2a2a;
      --header-text:#101010;
      --brand:#111;
      --muted:#121111;
      --chip:#0a0a0a;
      --primary: #d32f2f; /* Rojo de tu marca */
    }
    body{
      font-family:Arial,sans-serif;
      background:linear-gradient(135deg,#ffffff,#f2f2f2);
      color:#333;
      padding-top:var(--header-total);
      overflow-x: hidden; /* Evitar desplazamiento horizontal no deseado */
    }

    /* ====== INTRO FLY (solo el logo) ====== */
    .intro-fly{position:fixed;inset:0;background:transparent;z-index:9999;pointer-events:none}
    .intro-fly img{
      position:fixed;left:50%;bottom:-40vh;transform:translateX(-50%) scale(1);
      width:min(360px,78vw);height:auto;will-change:transform;
      filter:drop-shadow(0 16px 24px rgba(0,0,0,.45));background:transparent
    }
    @media (prefers-reduced-motion:reduce){.intro-fly{display:none!important}}

    /* ====== HEADER ====== */
    header{
      position:fixed;top:0;left:0;width:100%;
      background:var(--header-bg);color:var(--header-text);z-index:1000;
      display:grid;grid-template-columns:auto 1fr auto;grid-template-rows:auto auto;align-items:center;gap:10px;
      padding:10px 16px;border-bottom:1px solid var(--header-border);
    }
    .menu-toggle{display:flex;flex-direction:column;justify-content:space-between;width:25px;height:20px;cursor:pointer}
    .menu-toggle span{display:block;height:3px;background:var(--header-text);border-radius:2px}
    .logo{justify-self:center;position:relative;transform-style:preserve-3d;cursor:pointer}
    .logo img{width:clamp(140px,24vw,200px);display:block;will-change:transform;background:transparent}
    .logo .shine{
      position:absolute;inset:0;pointer-events:none;
      background:radial-gradient(120% 120% at var(--sx,30%) var(--sy,30%),rgba(255,255,255,.28),transparent 60%);
      mix-blend-mode:screen;opacity:.35;border-radius:10px
    }
    .cart{position:relative;cursor:pointer;font-size:1.6rem}
    .cart-badge{
      position:absolute;top:-6px;right:-8px;
      background:var(--primary);color:#fff;font-size:.72rem;line-height:1;
      padding:3px 6px;border-radius:999px;min-width:18px;text-align:center;display:none;
    }

    .header-search{grid-column:1/-1;position:relative}
    .header-search input{
      width:100%;max-width:680px;margin:6px auto 0;display:block;
      padding:10px 14px 10px 40px;font-size:1rem;border-radius:20px;
      border:1px solid var(--header-input-border);
      background:var(--header-bg);color:var(--header-text);
      outline:none;
    }
    .header-search i.fa-search{
      position:absolute;left:calc(50% - 340px + 15px);top:50%;transform:translateY(-50%);
      color:#bbb;
    }
    .header-search input::placeholder{color:#bbb}

    /* Menú lateral */
    nav{
      position:fixed;left:0;top:var(--header-total);
      width:220px;background:var(--header-bg);display:none;flex-direction:column;z-index:1001;
      border-right:1px solid var(--header-border);
    }
    nav.active{display:flex}
    nav a{color:#fff;padding:10px 15px;text-decoration:none;border-bottom:1px solid var(--header-border)}
    nav .submenu{display:flex;flex-direction:column}
    nav .submenu a{padding-left:25px}

    /* ====== CATÁLOGO (Vertical y Cuadrícula) ====== */
    main {
      max-width: 1200px;
      margin: 20px auto;
      padding: 0 20px;
    }
    .catalogo-container {
      position: relative;
    }
    .catalogo-title {
      font-size: 1.8rem;
      color: var(--brand);
      margin-bottom: 20px;
      text-align: center;
    }
    
    .category-filters {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }
    .category-filters button {
      padding: 8px 16px;
      border: 1px solid #ddd;
      background: white;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .category-filters button:hover, .category-filters button.active {
      background: var(--brand);
      color: white;
      border-color: var(--brand);
    }

  .catalogo {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 12px;
  padding: 10px 0;
}

/* En pantallas grandes (tablet/pc) ponemos más columnas */
@media (max-width: 480px) {
  .producto {
    padding: 10px;
    font-size: 0.95rem;
  }

 .producto img {
    width: 100%;
    aspect-ratio: 4 / 3;
    height: auto;
    object-fit: cover;
    border-radius: 6px;
  }

  .producto h4 {
    font-size: 1rem;
    margin: 8px 0 4px;
  }

  .producto p {
    font-size: 0.85rem;
  }

  .producto .price {
    font-size: 1.1rem;
  }

  .producto button {
    font-size: 0.9rem;
    padding: 8px;
    border-radius: 6px;
  }
}

    /* ====== CARRITO (pantalla completa) ====== */
    .cart-menu{
      position:fixed;inset:0;background:#fff;z-index:1100;
      transform:translateX(100%);transition:transform .35s ease;
      display:grid;grid-template-rows:auto 1fr auto;font-size:1.05rem;
    }
    .cart-menu.active{transform:translateX(0)}
    .cart-header{
      background:var(--header-bg);color:#fff;
      display:flex;justify-content:space-between;align-items:center;
      padding:12px 16px;font-size:1.1rem;
    }
    .cart-header .close{cursor:pointer;font-size:1.4rem;line-height:1}
    .cart-items{overflow-y:auto;padding:14px 16px;background:#fafafa}
    .cart-row{
      display:grid;grid-template-columns:90px 1fr auto auto auto;
      gap:12px;align-items:center;padding:12px 10px;background:#fff;border-radius:10px;margin-bottom:12px;box-shadow:0 2px 6px rgba(0,0,0,.06);
    }
    .cart-row .thumb{width:90px;height:70px;object-fit:cover;border-radius:8px;border:1px solid #eee}
    .cart-row a{color:#111;text-decoration:underline}
    .qty{display:inline-flex;align-items:center;gap:8px}
    .qty button{width:36px;height:36px;border:1px solid #ddd;background:#f7f7f7;border-radius:8px;cursor:pointer;font-size:1.1rem}
    .line{font-weight:700;white-space:nowrap}
    .actions{display:flex;gap:8px}
    .actions .rm{width:36px;height:36px;border:1px solid #e57373;background:#ffecec;border-radius:8px;cursor:pointer}
    .actions .rm span{display:block}

    .cart-footer{background:#fff;border-top:1px solid #eee;padding:12px 16px}
    .est-total{font-weight:800;margin:10px 0;font-size:1.08rem}
    .cart-note{font-size:.95rem;color:#666;margin:8px 0 10px}
    .cart-actions{display:flex;gap:10px;flex-wrap:wrap}
    .cart-actions button{padding:10px 12px;border-radius:10px;border:1px solid #ddd;background:#fff;cursor:pointer}
    .cart-actions .next{background:#111;color:#fff;border-color:#111}

    /* ====== CHECKOUT PANEL ====== */
    .checkout-panel{
      position:fixed;right:-100%;top:0;bottom:0;width:min(760px,100vw);
      background:#fff;box-shadow:-2px 12px 28px rgba(0,0,0,.3);
      padding:18px;transition:.35s ease;z-index:1200;border-radius:0;
      display:flex;flex-direction:column;overflow:hidden;font-size:1rem;
    }
    .checkout-panel.active{right:0}
    .checkout-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .checkout-body{flex:1;overflow:auto;padding-right:4px;display:grid;grid-template-columns:1fr;gap:16px}
    .section{background:#fff;border:1px solid #eee;border-radius:12px;padding:14px}

    form .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    form .row-1{display:grid;grid-template-columns:1fr;gap:12px}
    form label{display:block;font-size:.95rem;margin:8px 0 4px}
    form input, form select, form textarea{width:100%;padding:12px;border:1px solid #ddd;border-radius:10px;font-size:1rem}

    .secure{font-size:.92rem;color:var(--muted);margin-bottom:10px}
    .pay-options{display:flex;gap:16px;flex-wrap:wrap;margin-bottom:8px}
    .pay-options label{display:flex;align-items:center;gap:8px;cursor:pointer}
    .brands{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0 12px}
    .chip{background:var(--chip);border-radius:999px;padding:6px 10px;font-size:.9rem}
    .card-grid{display:grid;grid-template-columns:1fr;gap:12px}
    .card-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .card-grid label{margin:0}
    .card-grid input{font-family:inherit}

    .order-summary .line{display:flex;justify-content:space-between;align-items:center;margin:6px 0}
    .order-summary .line .label{color:var(--muted)}
    .order-summary .total{font-weight:900;font-size:1.1rem}
    
    .checkout-actions {
      display: flex;
      justify-content: space-between;
      padding: 16px;
      background: #fff;
      border-top: 1px solid #eee;
    }
    .checkout-actions .btn {
      padding: 12px 20px;
      border-radius: 10px;
      border: 1px solid #ddd;
      background: #fff;
      cursor: pointer;
    }
    .checkout-actions .primary {
      background: #111;
      color: #fff;
      border-color: #111;
    }
     .btn.whatsapp {
  background: #25D366;
  color: white;
  border: none;
  font-weight: bold;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  transition: background 0.3s;
}
.btn.whatsapp:hover {
  background: #20b857;
}
    /* ====== PRODUCT DETAIL MODAL ====== */
    .product-modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.6);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      padding: 20px;
      overflow-y: auto;
    }
    .product-modal-overlay.active {
      display: flex;
    }
    .product-modal-content {
      background: #fff;
      border-radius: 12px;
      width: 100%;
      max-width: 900px;
      padding: 25px;
      position: relative;
      animation: fadeInZoom 0.3s ease-out;
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }
    @keyframes fadeInZoom {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    .product-modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 1.8rem;
      cursor: pointer;
      color: #333;
    }
    .modal-image-area {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .modal-main-image {
     max-width: 100%;
      height: 300px; /* Altura fija para la imagen principal */
      object-fit: contain; /* Ajusta la imagen dentro del contenedor */
      border-radius: 8px;
      margin-bottom: 15px;
    }
    .modal-thumbnails {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      padding-bottom: 10px;
      -webkit-overflow-scrolling: touch;
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    .modal-thumbnails::-webkit-scrollbar {
      display: none;
    }
    .modal-thumbnail-img {
      width: 80px;
      height: 80px;
      object-fit: cover;
      border-radius: 6px;
      cursor: pointer;
      border: 2px solid #eee;
      transition: border-color 0.2s;
    }
    .modal-thumbnail-img.active, .modal-thumbnail-img:hover {
      border-color: var(--primary);
    }
    .modal-details {
      padding-top: 10px;
    }
    .modal-details h3 {
      font-size: 2rem;
      margin-bottom: 10px;
      color: var(--brand);
    }
    .modal-details p {
      margin-bottom: 8px;
      line-height: 1.5;
    }
    .modal-details .price {
      font-size: 1.6rem;
      color: var(--primary);
      margin: 15px 0;
    }
    .modal-add-to-cart-btn {
      background: var(--brand);
      color: #fff;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: bold;
      width: 100%;
      transition: background 0.3s;
    }
    .modal-add-to-cart-btn:hover {
      background: var(--primary);
    }


    /* ====== FOOTER ====== */
    footer{
      background:#111;
      color:#fff;
      text-align:center;
      padding:30px 20px;
      margin-top:50px;
    }
    footer a{
      color:#fff;
      margin:0 10px;
      text-decoration: none;
    }
    footer a:hover {
      text-decoration: underline;
    }
    .social-icons {
      margin: 15px 0;
      font-size: 1.5rem;
    }

    @media (min-width: 768px) {
      .product-modal-content {
        grid-template-columns: 1.2fr 1fr; /* Dos columnas para imágenes y detalles */
      }
      .modal-details {
        padding-top: 0;
      }
    }

    @media (max-width:767px){
      .header-search i.fa-search {
        left: 25px;
      }
      .catalogo-title {
        font-size: 1.5rem;
      }
      /* Los productos se adaptan a 1 columna por el auto-fill y min(280px, 100%) */
      .modal-main-image {
        height: 250px;
      }
    }
    
    @media (max-width:480px){
      .catalogo-title {
        text-align: left;
      }
      .producto h4 {
        font-size: 1rem;
      }
      .product-modal-content {
        padding: 20px;
      }
      .product-modal-close {
        font-size: 1.5rem;
        top: 10px;
        right: 10px;
      }
    }
  </style>
</head>
<body>

  <!-- INTRO FLY -->
  <div class="intro-fly" id="introFly">
    <img id="flyLogo" src="https://raw.githubusercontent.com/moiii174/MOISEZNEW/master/f29d95fd-4516-4b22-9366-e83ae03a9566_removalai_preview.png?v=12" alt="Logo WAESCAPS">
  </div>

  <!-- HEADER -->
  <header id="siteHeader">
    <div class="menu-toggle" id="menuToggle" aria-label="Abrir menú">
      <span></span><span></span><span></span>
    </div>

    <div class="logo" id="logoHeader3D" title="Ir al inicio">
      <img id="headerLogoImg" src="https://raw.githubusercontent.com/moiii174/MOISEZNEW/master/f29d95fd-4516-4b22-9366-e83ae03a9566_removalai_preview.png?v=12" alt="Logo WAESCAPS">
      <span class="shine" aria-hidden="true"></span>
    </div>

    <div class="cart" id="cartBtn" aria-label="Abrir carrito">
      🛒 <span id="cartBadge" class="cart-badge">0</span>
    </div>

    <div class="header-search">
      <i class="fas fa-search"></i>
      <input type="text" id="search" placeholder="Buscar">
    </div>

    <nav id="mainNav">
      <a href="#">Catálogo</a>
      <a href="#">Promociones</a>
      <a href="#">Contacto</a>
      <div class="submenu">
        <a href="#">Barbas Hats</a>
        <a href="#">Dante Hats</a>
        <a href="#">Rude Awakenings</a>
        <a href="#">31 Hats</a>
        <a href="#">Gallo Fino</a>
      </div>
    </nav>
  </header>

  <main>
    <div class="catalogo-container">
      <h2 class="catalogo-title"></h2>
      
      <div class="category-filters">
        <button class="active" data-category="all">Todas</button>
        <button data-category="Gallo Fino ">Gallo Fino</button>
        <button data-category="31 Hats">31 Hats</button>
        <button data-category="Anymore">Anymore</button>
        <button data-category="Barbas Hats">Barbas Hats</button>
        <button data-category="Innedit">Innedit</button>
      </div>
      
      <div class="catalogo" id="catalogo">
        <!-- Los productos se cargarán aquí dinámicamente con JavaScript -->
      </div>
      
      <div id="noResults" class="no-results">
        <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 15px;"></i>
        <h3>No se encontraron productos</h3>
        <p>Intenta con otros términos de búsqueda</p>
      </div>
    </div>
  </main>

  <!-- CARRITO FULLSCREEN -->
  <aside class="cart-menu" id="cartMenu">
    <div class="cart-header">
      <strong>Tu Carrito</strong>
      <span id="closeCart" class="close" title="Cerrar">✖</span>
    </div>
    <div class="cart-items" id="cartItems"></div>
    <div class="cart-footer">
      <div class="est-total" id="cartTotal">Total estimado: $0 MXN</div>
      <div class="cart-note">Impuestos, descuentos y envío calculados en la pantalla de pago.</div>
      <div class="cart-actions">
        <button id="clearCart">Vaciar carrito</button>
        <button class="next" id="goCheckout">Ir a pagar</button>
      </div>
    </div>
  </aside>

  <!-- CHECKOUT -->
  <aside class="checkout-panel" id="checkoutPanel">
  <div class="checkout-header">
    <h3>Finalizar compra</h3>
    <button class="btn" id="backToCart">← Volver al carrito</button>
  </div>
  <div class="checkout-body">

    <!-- ===== DATOS DEL CLIENTE ===== -->
   
    <div class="section">
      <form id="checkoutForm">
        <div class="row">
            <div class="row-1">
  <label for="email">Correo electrónico
    <input type="email" id="email" required placeholder="ejemplo@correo.com">
  </label>
</div> <label>Nombre
             <input type="text" id="firstName" required>
          </label>
          <label>Apellido
            <input type="text" id="lastName" required>
          </label>
        </div>

        <div class="row-1">
          <label>Dirección
            <input type="text" id="address1" required placeholder="Calle y número">
          </label>
        </div>

        <div class="row">
          <label>Ciudad
            <input type="text" id="city" required>
          </label>
          <label>Estado
            <select id="state" required></select>
          </label>
        </div>

        <div class="row">
          <label>Código Postal
            <input type="text" id="zip" required inputmode="numeric" pattern="[0-9]{4,6}">
          </label>
          <label>Teléfono
            <input type="tel" id="phone" required placeholder="+52 55 1234 5678">
          </label>
        </div>
      </form>
    </div>

    <!-- ===== RESUMEN DE PEDIDO ===== -->
    <div class="section order-summary">
      <div class="line"><span class="label">Artículos</span><span id="sumItemsCk">0</span></div>
      <div class="line"><span class="label">Subtotal</span><span id="sumSubtotalCk">$0 MXN</span></div>
      <div class="line"><span class="label">Envío (estimado)</span><span id="sumShippingCk">Calculado con tu dirección</span></div>
      <div class="line total"><span>Total</span><span id="sumTotalCk">$0 MXN</span></div>
      <div class="muted">Este pedido se confirmará contigo por WhatsApp.</div>
    </div>

  </div>

  <!-- ===== BOTÓN FINAL ===== -->
  <div class="checkout-actions">
    <button class="btn" id="backToCart2">← Volver</button>
    <button class="btn whatsapp" id="payNow">
      <i class="fab fa-whatsapp"></i> Finalizar por WhatsApp
    </button>
  </div>
</aside>

  <!-- PRODUCT DETAIL MODAL -->
  <div class="product-modal-overlay" id="productModalOverlay">
    <div class="product-modal-content">
      <span class="product-modal-close" id="productModalClose">✖</span>
      <div class="modal-image-area">
        <img src="" alt="Imagen principal del producto" class="modal-main-image" id="modalMainImage">
        <div class="modal-thumbnails" id="modalThumbnails">
          <!-- Miniaturas se cargarán aquí -->
        </div>
      </div>
      <div class="modal-details">
        <h3 id="modalProductName"></h3>
        <p id="modalProductDescription"></p>
        <p class="price" id="modalProductPrice"></p>
        <button class="modal-add-to-cart-btn" id="modalAddToCartBtn">Agregar al carrito</button>
      </div>
    </div>
  </div>

  <footer>
    <div class="social-icons">
      <a href="#"><i class="fab fa-instagram"></i></a>
      <a href="#"><i class="fab fa-facebook"></i></a>
      <a href="#"><i class="fab fa-whatsapp"></i></a>
    </div>
    <p>© 2025 WAESCAPS - Todos los derechos reservados</p>
  </footer>

  <script>
    // ============ CONFIG ============
    const LOGO_URL = 'https://raw.githubusercontent.com/moiii174/MOISEZNEW/master/f29d95fd-4516-4b22-9366-e83ae03a9566_removalai_preview.png?v=12';
    const fmt = new Intl.NumberFormat('es-MX', { maximumFractionDigits: 0 });
    const FREE_SHIP_THRESHOLD = 1200;

    // Datos de productos (AHORA CENTRALIZADOS)
    const productsData = [
      {
        id: 'Barbas Hats “Skate or Die”',
        name: 'Barbas Hats “Skate or Die”',
        price: 1650,
        category: 'nike',
        images: [
          'https://i.postimg.cc/05M8Rght/Captura-de-pantalla-7-9-2025-1332-mommsneakers-com.jpg',
          'https://i.postimg.cc/3wcPnNr3/Captura-de-pantalla-7-9-2025-13321-mommsneakers-com.jpg',
          'https://i.postimg.cc/cHtPjW6w/Captura-de-pantalla-7-9-2025-13328-mommsneakers-com.jpg',
          'https://i.postimg.cc/wjbfdrCV/Captura-de-pantalla-7-9-2025-13335-mommsneakers-com.jpg',
          'https://i.postimg.cc/PJ2bQph4/Captura-de-pantalla-7-9-2025-13342-mommsneakers-com.jpg'
        ]
      },
      {
        id: 'REBEL NEGRA',
        name: 'REBEL NEGRA',
        price: 1199,
        category: 'REBEL NEGRA',
        images: [
          'https://i.postimg.cc/bYVMHsJr/Captura-de-pantalla-7-9-2025-13556-mommsneakers-com.jpg',
          'https://i.postimg.cc/28PKMMnf/Captura-de-pantalla-7-9-2025-1365-mommsneakers-com.jpg',
          'https://i.postimg.cc/T3g460c5/Captura-de-pantalla-7-9-2025-13616-mommsneakers-com.jpg'
        ]
      },
      {
        id: 'RUDE AWAKENINGS “NY THORNES”',
        name: 'RUDE AWAKENINGS “NY THORNES”',
        price: 1950,
        category: 'RUDE AWAKENINGS “NY THORNES”',
        images: [
          'https://i.postimg.cc/9MKk2nsT/Captura-de-pantalla-7-9-2025-1384-mommsneakers-com.jpg',
          'https://i.postimg.cc/VkmVzMZ7/Captura-de-pantalla-7-9-2025-13810-mommsneakers-com.jpg',
          'https://i.postimg.cc/SxdtRswm/Captura-de-pantalla-7-9-2025-13821-mommsneakers-com.jpg'
        ]
      },
      {
        id: 'RUDE AWAKENINGS “LA THORNES”',
        name: 'RUDE AWAKENINGS “LA THORNES”',
        price: 1899 ,
        category: 'RUDE AWAKENINGS “LA THORNES”',
        images: [
          'https://i.postimg.cc/prxPxrwK/Captura-de-pantalla-7-9-2025-14252-mommsneakers-com.jpg',
          'https://i.postimg.cc/cJnWnfZQ/Captura-de-pantalla-7-9-2025-14259-mommsneakers-com.jpg',
          'https://i.postimg.cc/90JHhptj/Captura-de-pantalla-7-9-2025-1436-mommsneakers-com.jpg'
        ]
      },
      {
        id: 'RUDE AWAKENINGS CHRIST WHITE CRYSTALS',
        name: 'RUDE AWAKENINGS CHRIST WHITE CRYSTALS',
        price: 1399,
        category: 'RUDE AWAKENINGS CHRIST WHITE CRYSTALS',
        images: [
          'https://i.postimg.cc/NfSPrS0z/Captura-de-pantalla-7-9-2025-1454-mommsneakers-com.jpg'
        ]
      },
      {
        id: 'Innedit “Muratravis Utopía”',
        name: 'Innedit “Muratravis Utopía”',
        price: 1299 ,
        category: 'Innedit “Muratravis Utopía”',
        images: [
          'https://i.postimg.cc/SxL7NvY8/Captura-de-pantalla-7-9-2025-14648-mommsneakers-com.jpg',
          'https://i.postimg.cc/BvMT2Pgn/Captura-de-pantalla-7-9-2025-1471-mommsneakers-com.jpg'
        ]
      },
      {
        id: 'INNEDIT FLOWERS',
        name: 'INNEDIT FLOWERS',
        price: 1299 ,
        category: 'INNEDIT FLOWERS',
        images: [
          'https://i.postimg.cc/9XqxH1bP/Captura-de-pantalla-7-9-2025-14847-mommsneakers-com.jpg',
          'https://i.postimg.cc/4NkWft2D/Captura-de-pantalla-7-9-2025-14853-mommsneakers-com.jpg',
          'https://i.postimg.cc/x19gHQ2g/Captura-de-pantalla-7-9-2025-14858-mommsneakers-com.jpg'
        ]
      },
      {
        id: 'ICED OUT CASH',
        name: 'ICED OUT CASH',
        price: 1099  ,
        category: 'ICED OUT CASH',
        images: [
          'https://i.postimg.cc/nLC4YcwK/Captura-de-pantalla-7-9-2025-15111-mommsneakers-com.jpg'
        ]
      },
      {
        id: 'GERVONTA 2.0',
        name: 'GERVONTA 2.0',
        price: 1199   ,
        category: 'GERVONTA 2.0',
        images: [
          'https://i.postimg.cc/CLSbr4Qx/Captura-de-pantalla-7-9-2025-15259-mommsneakers-com.jpg',
          'https://i.postimg.cc/6p1R3x58/Captura-de-pantalla-7-9-2025-1534-mommsneakers-com.jpg',
          'https://i.postimg.cc/nzdt821f/Captura-de-pantalla-7-9-2025-15351-mommsneakers-com.jpg'
          
        ]
      },
       {
        id: 'Baez x Oscar Maydon “Rompe la Dompe”',
        name: 'Baez x Oscar Maydon “Rompe la Dompe”',
        price: 1499,
        category: 'Baez x Oscar Maydon “Rompe la Dompe”',
        images: [
          'https://i.postimg.cc/PJQgT4HM/Captura-de-pantalla-7-9-2025-12727-mommsneakers-com.jpg',
          'https://i.postimg.cc/52RZ4yhD/Captura-de-pantalla-7-9-2025-12733-mommsneakers-com.jpg',
          'https://i.postimg.cc/LsgGnRR5/Captura-de-pantalla-7-9-2025-12740-mommsneakers-com.jpg',
           'https://i.postimg.cc/LsgGnRR5/Captura-de-pantalla-7-9-2025-12740-mommsneakers-com.jpg'
          
        ]
      }
    ];

    // Header height padding
    const headerEl = document.getElementById('siteHeader');
    function setHeaderVar(){ document.documentElement.style.setProperty('--header-total', headerEl.offsetHeight + 'px'); }
    window.addEventListener('load', setHeaderVar);
    window.addEventListener('resize', ()=>{ requestAnimationFrame(setHeaderVar); });

    // Menú
    const menuToggle = document.getElementById("menuToggle");
    const mainNav = document.getElementById("mainNav");
    menuToggle.addEventListener("click", ()=> mainNav.classList.toggle("active"));

    // Carrito y panel de pago
    const cartBtn = document.getElementById("cartBtn");
    const cartBadge = document.getElementById("cartBadge");
    const cartMenu = document.getElementById("cartMenu");
    const closeCart = document.getElementById("closeCart");
    const goCheckout = document.getElementById("goCheckout");
    const clearCartBtn = document.getElementById("clearCart");
    const checkoutPanel = document.getElementById("checkoutPanel");
    const backToCart = document.getElementById("backToCart");
    const backToCart2 = document.getElementById("backToCart2");

    cartBtn.addEventListener("click", ()=> cartMenu.classList.toggle("active"));
    closeCart.addEventListener("click", ()=> cartMenu.classList.remove("active"));
    goCheckout.addEventListener("click", ()=>{
      if (!cart.length) return;
      cartMenu.classList.remove("active");
      checkoutPanel.classList.add("active");
      updateSummary();
    });
    backToCart.addEventListener("click", ()=> { checkoutPanel.classList.remove("active"); cartMenu.classList.add("active"); });
    backToCart2.addEventListener("click", ()=> { checkoutPanel.classList.remove("active"); cartMenu.classList.add("active"); });

    // Buscador
    const searchInput = document.getElementById("search");
    const catalogoEl = document.getElementById("catalogo");
    const noResults = document.getElementById("noResults");

    function norm(s){ return s.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,''); }
    let searchTimeout;

    searchInput.addEventListener("input", function(){
      clearTimeout(searchTimeout);
      const value = norm(this.value.trim());
      searchTimeout = setTimeout(()=>{
        filterAndRenderProducts(currentCategory, value); // Filtra por categoría activa y búsqueda
      }, 200);
    });

    // Tilt 3D + click al inicio
    function initLogo3D(el,{maxTiltX=8,maxTiltY=12}={}){
      if(!el) return;
      let targetRX=0,targetRY=0,currentRX=0,currentRY=0;
      const lerp=(a,b,t)=>a+(b-a)*t;
      function animate(){
        currentRX = lerp(currentRX,targetRX,0.14);
        currentRY = lerp(currentRY,targetRY,0.14);
        el.style.setProperty('--rx', currentRX.toFixed(2)+'deg');
        el.style.setProperty('--ry', currentRY.toFixed(2)+'deg');
        el.style.transform = `rotateX(var(--rx)) rotateY(var(--ry))`;
        requestAnimationFrame(animate);
      }
      animate();
      function onPointerMove(e){
        const r=el.getBoundingClientRect();
        const x=(e.clientX-r.left)/r.width, y=(e.clientY-r.top)/r.height;
        targetRY=(x-0.5)*(maxTiltY*2); targetRX=(0.5-y)*(maxTiltX*2);
        el.style.setProperty('--sx',(x*100).toFixed(1)+'%');
        el.style.setProperty('--sy',(y*100).toFixed(1)+'%');
      }
      function onLeave(){targetRX=0;targetRY=0;el.style.removeProperty('--sx');el.style.removeProperty('--sy')}
      el.addEventListener('pointermove',onPointerMove);
      el.addEventListener('pointerenter',onPointerMove);
      el.addEventListener('pointerleave',onLeave);
      el.addEventListener('click', (e)=>{ e.preventDefault(); window.scrollTo({ top: 0, behavior: 'smooth' }); });
    }
    initLogo3D(document.getElementById('logoHeader3D'), {maxTiltX:8,maxTiltY:12});

    // Transparencia del logotipo (opcional)
    async function fetchBlob(url){
      try{ const res = await fetch(url, { cache: 'reload' }); if(!res.ok) throw 0; return await res.blob(); }
      catch(e){
        try{ const res2 = await fetch('https://cors.isomorphic-git.org/' + url, { cache: 'reload' }); if(!res2.ok) throw 0; return await res2.blob(); }
        catch(_){ return null; }
      }
    }
    function imgFromBlob(blob){
      return new Promise((resolve,reject)=>{
        if(!blob) return reject('no blob');
        const url = URL.createObjectURL(blob);
        const img = new Image();
        img.onload = ()=>{ URL.revokeObjectURL(url); resolve(img); };
        img.onerror = reject; img.src = url;
      });
    }
    function makeTransparent(img, {threshold=85, softness=55, maxSide=1600} = {}){
      let w = img.naturalWidth, h = img.naturalHeight;
      const scale = Math.min(1, maxSide / Math.max(w,h));
      if (scale < 1) { w = Math.round(w*scale); h = Math.round(h*scale); }
      const canvas = document.createElement('canvas'); canvas.width = w; canvas.height = h;
      const ctx = canvas.getContext('2d'); ctx.drawImage(img, 0, 0, w, h);
      const imgData = ctx.getImageData(0,0,w,h); const d = imgData.data;
      let r=0,g=0,b=0,count=0, step=Math.max(1, Math.floor(Math.min(w,h)/50));
      for (let x=0; x<w; x+=step) { let i=(x)*4; r+=d[i]; g+=d[i+1]; b+=d[i+2]; count++; let j=((h-1)*w + x)*4; r+=d[j]; g+=d[j+1]; b+=d[j+2]; count++; }
      for (let y=0; y<h; y+=step) { let i=(y*w)*4; r+=d[i]; g+=d[i+1]; b+=d[i+2]; count++; let j=(y*w + (w-1))*4; r+=d[j]; g+=d[j+1]; b+=d[j+2]; count++; }
      r/=count; g/=count; b/=count;
      for (let i=0; i<d.length; i+=4) {
        const dr=d[i]-r, dg=d[i+1]-g, db=d[i+2]-b;
        const dist=Math.sqrt(dr*dr+dg*dg+db*db);
        if (dist <= threshold) d[i+3]=0;
        else if (dist <= threshold+softness) d[i+3]=Math.round(d[i+3]*(dist-threshold)/softness);
      }
      ctx.putImageData(imgData, 0, 0);
      return canvas.toDataURL('image/png');
    }
    (async function initLogoTransparency(){
      try{
        const blob = await fetchBlob(LOGO_URL);
        const img = await imgFromBlob(blob);
        const transparentURL = makeTransparent(img, {threshold: 85, softness: 55, maxSide: 1600});
        const headerLogoImg = document.getElementById('headerLogoImg');
        const flyImg = document.getElementById('flyLogo');
        if (headerLogoImg) headerLogoImg.src = transparentURL;
        if (flyImg) flyImg.src = transparentURL;
      }catch(e){}
    })();

    // Intro Fly
    (function flyLogoToHeader(){
      const fly = document.getElementById('introFly');
      const flyImg = document.getElementById('flyLogo');
      const headerLogoImg = document.getElementById('headerLogoImg');
      if(!fly||!flyImg||!headerLogoImg) return;
      let started=false;
      const prefersReduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const prevOpacity = headerLogoImg.style.opacity; headerLogoImg.style.opacity = '0';
      function begin(){
        if(started) return; started=true;
        if(prefersReduce){ fly.remove(); headerLogoImg.style.opacity = prevOpacity || '1'; return; }
        requestAnimationFrame(()=>{
          const sr = flyImg.getBoundingClientRect(), er = headerLogoImg.getBoundingClientRect();
          if(!sr.width || !er.width){ started=false; return setTimeout(begin,80); }
          const dx = (er.left + er.width/2) - (sr.left + sr.width/2);
          const dy = (er.top + er.height/2) - (sr.top + sr.height/2);
          const scale = er.width / sr.width;
          const anim = flyImg.animate([
            { transform: 'translateX(-50%) translate(0, 0) scale(1)', opacity: 1 },
            { transform: `translateX(-50%) translate(${dx*0.85}px, ${dy*0.85}px) scale(${1 + (scale-1)*0.85})`, opacity: 1, offset: 0.7 },
            { transform: `translateX(-50%) translate(${dx}px, ${dy}px) scale(${scale})`, opacity: 1 }
          ], { duration: 900, easing: 'cubic-bezier(0.22,1,0.36,1)', fill: 'forwards' });
          anim.onfinish = ()=>{ fly.remove(); headerLogoImg.style.opacity = prevOpacity || '1'; };
        });
      }
      if(headerLogoImg.complete && flyImg.complete) begin();
      else {
        const tryBegin=()=>begin();
        headerLogoImg.addEventListener('load', tryBegin, {once:true});
        flyImg.addEventListener('load', tryBegin, {once:true});
        setTimeout(tryBegin, 900);
      }
    })();

    // ====== CARRITO / TOTALES ======
    const cartItemsEl = document.getElementById('cartItems');
    const cartTotalEl = document.getElementById('cartTotal');
    let cart = []; // {id,name,price,qty,img}

    const fmtMXN = n => `$${fmt.format(n)} MXN`;
    const countItems = () => cart.reduce((s,i)=> s + i.qty, 0);
    const subtotal = () => cart.reduce((s,i)=> s + i.price*i.qty, 0);

    function updateBadge(){
      const n = countItems();
      if (!cartBadge) return;
      cartBadge.textContent = n;
      cartBadge.style.display = n ? 'inline-block' : 'none';
    }

    function renderCart(){
      cartItemsEl.innerHTML = "";
      cart.forEach((item, idx)=>{
        const row = document.createElement('div');
        row.className = 'cart-row';
        const prodAnchor = `#prod-${item.id}`; // Esto ya no es tan relevante con el modal
        row.innerHTML = `
          <img class="thumb" src="${item.img}" alt="${item.name}">
          <a href="#" onclick="event.preventDefault(); openProductModal('${item.id}');" class="prod-link" title="Ver producto">${item.name}</a>
          <div class="qty">
            <button class="dec" data-i="${idx}" title="Restar">−</button>
            <span>${item.qty}</span>
            <button class="inc" data-i="${idx}" title="Agregar">+</button>
          </div>
          <span class="line">${fmtMXN(item.price * item.qty)}</span>
          <div class="actions">
            <button class="rm" data-i="${idx}" title="Eliminar"><span>🗑️</span></button>
          </div>
        `;
        cartItemsEl.appendChild(row);
      });
      // Badge del header
      updateBadge();
      // Total estimado
      cartTotalEl.textContent = `Total estimado: ${fmtMXN(subtotal())}`;
    }

    cartItemsEl.addEventListener('click', (e)=>{
      const btn = e.target.closest('button');
      if (!btn) return;
      const i = parseInt(btn.dataset.i);
      if (isNaN(i) || i < 0 || i >= cart.length) return;

      if (btn.classList.contains('inc')) cart[i].qty += 1;
      else if (btn.classList.contains('dec')) cart[i].qty = Math.max(1, cart[i].qty - 1);
      else if (btn.classList.contains('rm')) cart.splice(i,1);
      
      renderCart();
      updateSummary();
    });

    document.getElementById('clearCart').addEventListener('click', ()=>{
      cart = []; renderCart(); updateSummary();
    });

   function addToCart(name, price, id, img, buttonElement = null){
  const ix = cart.findIndex(p => p.id === id);

  if (ix > -1) {
    cart[ix].qty += 1;
  } else {
    cart.push({
      id,
      name,
      price: Number(price),
      qty: 1,
      img: img || (productsData.find(p => p.id === id)?.images?.[0] || '')
    });
  }

  updateBadge();
  renderCart();
  updateSummary();

  // Retroalimentación visual en el botón
  if (buttonElement) {
    const originalText = buttonElement.textContent;
    buttonElement.textContent = "✓ Agregado";
    buttonElement.style.background = "#4caf50";
    setTimeout(() => {
      buttonElement.textContent = originalText;
      buttonElement.style.background = "";
    }, 1500);
  }
}

    // ====== CHECKOUT: estados de México ======
    const mexStates = [
      "Aguascalientes","Baja California","Baja California Sur","Campeche","Chiapas","Chihuahua","Ciudad de México",
      "Coahuila","Colima","Durango","Estado de México","Guanajuato","Guerrero","Hidalgo","Jalisco",
      "Michoacán","Morelos","Nayarit","Nuevo León","Oaxaca","Puebla","Querétaro","Quintana Roo",
      "San Luis Potosí","Sinaloa","Sonora","Tabasco","Tamaulipas","Tlaxcala","Veracruz","Yucatán","Zacatecas"
    ];
    const stateSel = document.getElementById('state');
    mexStates.forEach(st=>{
      const opt = document.createElement('option'); opt.value = st; opt.textContent = st; stateSel.appendChild(opt);
    });

    // Estimar envío
    function estimateShipping(state, zip, subAfter){
      if (subAfter >= FREE_SHIP_THRESHOLD) return 0;
      if (!state) return null;
      const north = ["Baja California","Baja California Sur","Chihuahua","Coahuila","Sonora","Quintana Roo"];
      let base = 99;
      if (state === "Ciudad de México" || state === "Estado de México") base = 79;
      else if (north.includes(state)) base = 129;
      return base;
    }

    // Resumen checkout
    const sumItemsCk = document.getElementById('sumItemsCk');
    const sumSubtotalCk = document.getElementById('sumSubtotalCk');
    const sumShippingCk = document.getElementById('sumShippingCk');
    const sumTotalCk = document.getElementById('sumTotalCk');

    function updateSummary(){
      const items = countItems();
      const sub = subtotal();
      const state = document.getElementById('state')?.value || ''; // Usar optional chaining
      const zip = document.getElementById('zip')?.value.trim() || '';
      const ship = estimateShipping(state, zip, sub);

      sumItemsCk.textContent = items;
      sumSubtotalCk.textContent = fmtMXN(sub);
      sumShippingCk.textContent = (ship==null) ? 'Calculado con tu dirección' : fmtMXN(ship);
      sumTotalCk.textContent = (ship==null) ? fmtMXN(sub) : fmtMXN(sub + ship);
    }

    // Inputs que afectan resumen
    ['email','country','firstName','lastName','address1','address2','zip','city','state','phone'].forEach(id=>{
      const el = document.getElementById(id);
      if (el) { // Verificar si el elemento existe
        el.addEventListener('input', updateSummary);
        el.addEventListener('change', updateSummary);
      }
    });

    // ====== Checkout por WhatsApp ======
const payNowBtn = document.getElementById('payNow');
if (payNowBtn) {
  payNowBtn.addEventListener('click', ()=>{
    if (!cart.length){ 
      alert('Tu carrito está vacío 🤷‍♂️'); 
      return; 
    }
    
    // Validar campos básicos
    const requiredIds = ['firstName','lastName','address1','city','state','zip','phone'];
    for (const id of requiredIds){
      const el = document.getElementById(id);
      if (el && !el.value.trim()){ 
        alert('Por favor completa todos los datos de envío 📦'); 
        return; 
      }
    }

    // Recoger datos del formulario
    const nombre = document.getElementById('firstName').value;
    const apellido = document.getElementById('lastName').value;
    const direccion = document.getElementById('address1').value;
    const ciudad = document.getElementById('city').value;
    const estado = document.getElementById('state').value;
    const zip = document.getElementById('zip').value;
    const telefono = document.getElementById('phone').value;

    // Texto que llegará a tu WhatsApp
    let pedido = "🧢 *Nuevo pedido WAESCAPS*%0A%0A";
    pedido += `👤 Cliente: ${nombre} ${apellido}%0A`;
    pedido += `📍 Dirección: ${direccion}, ${ciudad}, ${estado}, CP ${zip}%0A`;
    pedido += `📞 Tel: ${telefono}%0A%0A`;
    pedido += "*Productos:*%0A";
    
    cart.forEach(p=>{
      pedido += `- ${p.qty} × ${p.name} (${fmtMXN(p.price)})%0A`;
    });
    
    pedido += `%0A💰 Total: ${fmtMXN(subtotal())}`;

    // ☎️ Tu número de WhatsApp FORMATO CORRECTO
    const tuNumero = "5219984955797"; // <- este es tu número sin + ni espacios

    // Abre WhatsApp (móvil o web)
    const url = `https://wa.me/${tuNumero}?text=${pedido}`;
    window.open(url, "_blank");
  });
}

    // Mostrar/ocultar formulario de tarjeta
    const cardForm = document.getElementById('cardForm');
    document.querySelectorAll('input[name="payMethod"]').forEach(r=>{
      r.addEventListener('change', ()=>{
        if (cardForm) {
          cardForm.style.display = r.value === 'card' ? 'grid' : 'none';
        }
      });
    });

    // Formato de tarjeta
    const cardNumberInput = document.getElementById('cardNumber');
    const cardExpInput = document.getElementById('cardExp');
    if (cardNumberInput) {
      function formatCardNumber(v){ return v.replace(/\D/g,'').replace(/(.{4})/g,'$1 ').trim(); }
      cardNumberInput.addEventListener('input', (e)=> e.target.value = formatCardNumber(e.target.value));
    }
    if (cardExpInput) {
      cardExpInput.addEventListener('input', (e)=>{
        let v = e.target.value.replace(/\D/g,'').slice(0,4);
        if (v.length>=3) v = v.slice(0,2) + '/' + v.slice(2);
        e.target.value = v;
      });
    }

    // ====== LÓGICA DEL CATÁLOGO DINÁMICO Y MODAL ======
    let currentCategory = 'all'; // Categoría activa para el filtro

    // Función para renderizar los productos en el catálogo
    function renderProducts(productsToRender) {
      catalogoEl.innerHTML = ""; // Limpiar catálogo actual
      if (productsToRender.length === 0) {
        noResults.style.display = 'block';
        return;
      } else {
        noResults.style.display = 'none';
      }

      productsToRender.forEach(product => {
        const article = document.createElement('article');
        article.className = `producto ${product.category}`;
        article.dataset.category = product.category;
        article.dataset.id = product.id; // Añadir ID para fácil acceso
        article.innerHTML = `
          <img src="${product.images[0]}" alt="${product.name}" loading="lazy" width="200" height="180">
          <h4>${product.name}</h4>
          <p>${product.description}</p>
          <p class="price">${fmtMXN(product.price)}</p>
          <button class="add-to-cart-btn" data-product-id="${product.id}">Agregar al carrito</button>
        `;
       // Evento SOLO para abrir el modal, si se hace clic en cualquier parte EXCEPTO el botón
// Evento SOLO para abrir el modal, si se hace clic en cualquier parte EXCEPTO el botón
// Evento SOLO para abrir el modal, si se hace clic en cualquier parte EXCEPTO el botón
article.addEventListener('click', (e) => {
  if (!e.target.closest('.add-to-cart-btn')) {
    openProductModal(product.id);
  }
});

// Evento para el botón "Agregar al carrito" DIRECTO
const button = article.querySelector('.add-to-cart-btn');
button.addEventListener('click', (e) => {
  e.stopPropagation(); // Evita que se dispare el modal
  const prod = productsData.find(p => p.id === button.dataset.productId);
  if (prod) addToCart(prod.name, prod.price, prod.id, prod.images[0], button);
});

        catalogoEl.appendChild(article);
      });
    }

    // Función para filtrar y renderizar productos
    function filterAndRenderProducts(category, searchTerm = '') {
  let filtered = productsData;

  // Filtrar por categoría
  if (category !== 'all') {
    filtered = filtered.filter(p => p.category === category);
  }

  // Filtrar por búsqueda
  if (searchTerm) {
    const normalizedSearchTerm = norm(searchTerm);
    filtered = filtered.filter(p =>
      norm(p.name).includes(normalizedSearchTerm) ||
      norm(p.category).includes(normalizedSearchTerm)
    );
  }

  renderProducts(filtered);
}

    // Filtros de categoría
    const categoryButtons = document.querySelectorAll('.category-filters button');
    categoryButtons.forEach(button => {
      button.addEventListener('click', () => {
        categoryButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        currentCategory = button.dataset.category;
        filterAndRenderProducts(currentCategory, searchInput.value.trim()); // Re-filtra con categoría y búsqueda
      });
    });

    // ====== MODAL DE DETALLE DE PRODUCTO ======
    const productModalOverlay = document.getElementById('productModalOverlay');
    const productModalClose = document.getElementById('productModalClose');
    const modalMainImage = document.getElementById('modalMainImage');
    const modalThumbnails = document.getElementById('modalThumbnails');
    const modalProductName = document.getElementById('modalProductName');
    const modalProductDescription = document.getElementById('modalProductDescription');
    const modalProductPrice = document.getElementById('modalProductPrice');
    const modalAddToCartBtn = document.getElementById('modalAddToCartBtn');

    function openProductModal(productId) {
      const product = productsData.find(p => p.id === productId);
      if (!product) return;

      modalProductName.textContent = product.name;
      modalProductDescription.textContent = product.description;
      modalProductPrice.textContent = fmtMXN(product.price);
      modalAddToCartBtn.dataset.productId = product.id; // Para añadir al carrito desde el modal

      // Configurar imagen principal
      modalMainImage.src = product.images[0];
      modalMainImage.alt = product.name;

      // Configurar miniaturas
      modalThumbnails.innerHTML = '';
      product.images.forEach((imgSrc, index) => {
        const thumbnail = document.createElement('img');
        thumbnail.src = imgSrc;
        thumbnail.alt = `${product.name} - Vista ${index + 1}`;
        thumbnail.className = 'modal-thumbnail-img';
        if (index === 0) thumbnail.classList.add('active'); // Marcar la primera como activa
        thumbnail.addEventListener('click', () => {
          modalMainImage.src = imgSrc;
          // Remover clase activa de todas y añadirla a la clickeada
          document.querySelectorAll('.modal-thumbnail-img').forEach(t => t.classList.remove('active'));
          thumbnail.classList.add('active');
        });
        modalThumbnails.appendChild(thumbnail);
      });

      // Evento para añadir al carrito desde el modal
      modalAddToCartBtn.onclick = (e) => {
        const prod = productsData.find(p => p.id === e.target.dataset.productId);
        if (prod) addToCart(prod.name, prod.price, prod.id, prod.images[0]);
        // Opcional: Cerrar modal después de agregar al carrito
        closeProductModal();
      };

      productModalOverlay.classList.add('active');
      document.body.style.overflow = 'hidden'; // Evitar scroll del body
    }

    function closeProductModal() {
      productModalOverlay.classList.remove('active');
      document.body.style.overflow = ''; // Habilitar scroll del body
    }

    productModalClose.addEventListener('click', closeProductModal);
    productModalOverlay.addEventListener('click', (e) => {
      if (e.target === productModalOverlay) { // Solo cerrar si se hace click en el fondo oscuro
        closeProductModal();
      }
    });

    // Renderizado inicial
    renderProducts(productsData); // Muestra todos los productos al cargar
    renderCart();
    updateSummary();

// Botón negro, texto blanco, con esquinas redondeadas y un poquito más grande
(() => {
  const style = document.createElement('style');
  style.textContent = `
    .add-to-cart-btn, .modal-add-to-cart-btn {
      background: #111 !important;   /* negro */
      color: #fff !important;         /* letras blancas */
      border: 1px solid #111 !important;
      border-radius: 10px !important; /* redondeado suave */
      font-size: 1.1rem !important;   /* un poquito más grande */
      padding: 14px 18px !important;  /* más alto/ancho */
      min-height: 44px !important;    /* buena zona de clic */
      cursor: pointer !important;
    }
    .add-to-cart-btn:hover, .modal-add-to-cart-btn:hover {
      background: #000 !important;    /* hover más oscuro */
      border-color: #000 !important;
    }
    .add-to-cart-btn:active, .modal-add-to-cart-btn:active {
      background: #1c1c1c !important; /* presionado */
      border-color: #1c1c1c !important;
    }
  `;
  document.head.appendChild(style);
})();

// Color del botón de menú (hamburguesa) igual que el carrito
(() => {
  const style = document.createElement('style');
  style.textContent = `
    /* Si usas el ícono de Font Awesome */
    .menu-toggle, 
    .menu-toggle i {
      color: #fff !important;         /* mismo color que el carrito */
      font-size: 1.6rem;               /* tamaño cómodo */
    }

    /* Si sigues usando las 3 rayitas con <span> */
    .menu-toggle span {
      background: #fff !important;     /* que se vean en fondo negro */
    }
  `;
  document.head.appendChild(style);
})();

// Cerrar carrito al tocar fuera (overlay) o deslizar a la derecha
(() => {
  const cartMenu = document.getElementById('cartMenu');
  if (!cartMenu) return;

  // 1) Estilos y overlay detrás del carrito
  const style = document.createElement('style');
  style.textContent = `
    .cart-overlay {
      position: fixed; inset: 0;
      background: rgba(0,0,0,.45);
      opacity: 0; visibility: hidden;
      transition: opacity .25s ease, visibility 0s linear .25s;
      z-index: 1090; /* debajo del carrito (1100) */
    }
    .cart-overlay.active {
      opacity: 1; visibility: visible;
      transition: opacity .25s ease;
    }
  `;
  document.head.appendChild(style);

  const overlay = document.createElement('div');
  overlay.id = 'cartOverlay';
  overlay.className = 'cart-overlay';
  document.body.appendChild(overlay);

  // 2) Sincronizar overlay con el estado del carrito (abre/cierra)
  const syncOverlay = () => {
    overlay.classList.toggle('active', cartMenu.classList.contains('active'));
  };
  const mo = new MutationObserver(syncOverlay);
  mo.observe(cartMenu, { attributes: true, attributeFilter: ['class'] });
  syncOverlay();

  // Tocar el fondo cierra
  overlay.addEventListener('click', () => cartMenu.classList.remove('active'));
  // Tecla ESC también cierra
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && cartMenu.classList.contains('active')) {
      cartMenu.classList.remove('active');
    }
  });

  // 3) Deslizar a la derecha para cerrar (touch y mouse)
  let startX = 0, startY = 0, dx = 0, dragging = false, horizontal = false;

  const getWidth = () => cartMenu.clientWidth || window.innerWidth;

  function onStart(e) {
    if (!cartMenu.classList.contains('active')) return;
    const t = e.touches ? e.touches[0] : e;
    startX = t.clientX; startY = t.clientY;
    dx = 0; dragging = true; horizontal = false;
    cartMenu.style.transition = 'none';
  }

  function onMove(e) {
    if (!dragging) return;
    const t = e.touches ? e.touches[0] : e;
    const dX = t.clientX - startX;
    const dY = t.clientY - startY;

    if (!horizontal) {
      if (Math.abs(dX) < 6 && Math.abs(dY) < 6) return; // aún no decidimos
      horizontal = Math.abs(dX) > Math.abs(dY);
    }
    if (!horizontal) return; // permitir scroll vertical normal

    e.preventDefault(); // controlamos el gesto horizontal
    dx = Math.max(0, dX); // solo hacia la derecha
    cartMenu.style.transform = `translateX(${dx}px)`;

    const prog = Math.min(1, dx / getWidth());
    overlay.style.opacity = String(0.45 * (1 - prog)); // desvanece overlay
  }

  function animateToX(targetX, cb) {
    cartMenu.style.transition = 'transform .25s ease';
    cartMenu.style.transform = `translateX(${targetX})`;
    const onEnd = (ev) => {
      if (ev.propertyName !== 'transform') return;
      cartMenu.removeEventListener('transitionend', onEnd);
      cartMenu.style.transition = '';
      cb && cb();
    };
    cartMenu.addEventListener('transitionend', onEnd);
  }

  function onEnd() {
    if (!dragging) return;
    dragging = false;

    const shouldClose = dx > Math.max(90, getWidth() * 0.25); // umbral
    if (shouldClose) {
      // anima fuera y luego cierra
      animateToX('100%', () => {
        cartMenu.classList.remove('active');
        cartMenu.style.transform = '';
        overlay.classList.remove('active');
        overlay.style.opacity = '';
      });
    } else {
      // vuelve a posición original
      animateToX('0px', () => {
        cartMenu.style.transform = '';
        overlay.style.opacity = '';
      });
    }
  }

  // Touch
  cartMenu.addEventListener('touchstart', onStart, { passive: true });
  cartMenu.addEventListener('touchmove', onMove, { passive: false });
  cartMenu.addEventListener('touchend', onEnd);

  // Mouse (opcional en desktop)
  let mm, mu;
  cartMenu.addEventListener('mousedown', (e) => {
    onStart(e);
    mm = (ev) => onMove(ev);
    mu = () => { onEnd(); document.removeEventListener('mousemove', mm); document.removeEventListener('mouseup', mu); };
    document.addEventListener('mousemove', mm);
    document.addEventListener('mouseup', mu);
  });
})();


  </script>
</body>

</html>

